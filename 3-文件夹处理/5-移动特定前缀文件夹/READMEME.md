# 文件夹前缀移动工具

## 功能描述

这是一个用于批量移动文件夹的Python脚本工具。它能够递归扫描指定路径下的所有子文件夹，找到带有特定前缀的文件夹，并将其移动到目标路径中，同时保留原始的路径结构。

## 主要特性

- 🔍 **递归扫描**：自动扫描指定路径下的所有子文件夹
- 🎯 **前缀匹配**：精确匹配以指定前缀开头的文件夹
- 📁 **路径保持**：在移动时保留完整的原始路径结构
- 🛡️ **安全操作**：支持试运行模式，可预览操作结果
- 📝 **详细日志**：提供详细的操作日志和错误信息

## 使用场景

### 典型应用场景

1. **数据集整理**：从大量子文件夹中提取特定类型的样本
2. **文件分类**：按命名规则重新组织文件夹结构
3. **批量处理**：对具有特定命名模式的文件夹进行批量操作

### 示例场景

假设您有以下目录结构：
```
D:\a\
├── 中文文件夹1\
│   ├── B1\          ← 匹配前缀"B"
│   ├── B2\          ← 匹配前缀"B"
│   └── A1\
├── 中文文件夹2\
│   ├── B3\          ← 匹配前缀"B"
│   └── C1\
└── 其他文件夹\
    └── B4\          ← 匹配前缀"B"
```

使用前缀 `"B"` 处理后，结果将是：
```
D:\result\
├── 中文文件夹1\
│   ├── B1\
│   └── B2\
├── 中文文件夹2\
│   └── B3\
└── 其他文件夹\
    └── B4\
```

## 安装要求

### 系统要求
- Python 3.6 或更高版本
- Windows/Linux/macOS 系统

### 依赖库
- `os` (Python标准库)
- `shutil` (Python标准库)
- `pathlib` (Python标准库)

## 配置说明

### 修改配置参数

在脚本的配置区域修改以下参数：

```python
# ==================== 配置区域 ====================

# 处理路径：包含多个子文件夹的根目录
PROCESS_PATH = r"D:\a"  # 修改为你的处理路径

# 目标路径：结果将保存到该路径
TARGET_PATH = r"D:\result"  # 修改为你的目标路径

# 要查找的文件夹前缀
FOLDER_PREFIX = "B"  # 修改为你需要的前缀

# 是否启用试运行模式（True=只预览不移动，False=实际移动）
DRY_RUN = False

# ==================== 配置区域结束 ====================
```

### 参数说明

| 参数 | 说明 | 示例 |
|------|------|------|
| `PROCESS_PATH` | 要处理的根目录路径 | `r"D:\a"` |
| `TARGET_PATH` | 结果保存的目标路径 | `r"D:\result"` |
| `FOLDER_PREFIX` | 要查找的文件夹前缀 | `"B"` |
| `DRY_RUN` | 试运行模式开关 | `True` 或 `False` |

## 使用方法

### 1. 基本使用步骤

1. **修改配置**：打开 `move_prefix_folders.py` 文件，修改配置区域的参数
2. **试运行**：将 `DRY_RUN` 设置为 `True`，运行脚本预览操作
3. **确认操作**：检查预览结果无误后，将 `DRY_RUN` 设置为 `False`
4. **执行移动**：重新运行脚本执行实际的文件夹移动操作

### 2. 运行命令

```bash
# 在脚本所在目录运行
python move_prefix_folders.py
```

### 3. 使用示例

#### 示例1：移动所有以"B"开头的文件夹

```python
PROCESS_PATH = r"D:\数据集\原始数据"
TARGET_PATH = r"D:\数据集\B类数据"
FOLDER_PREFIX = "B"
DRY_RUN = False
```

#### 示例2：移动所有以"IMG"开头的文件夹

```python
PROCESS_PATH = r"C:\照片库\2024年"
TARGET_PATH = r"C:\照片库\精选照片"
FOLDER_PREFIX = "IMG"
DRY_RUN = False
```

## 输出说明

### 运行日志示例

```
文件夹前缀移动工具
==================================================
处理路径: D:\a
目标路径: D:\result
文件夹前缀: B
试运行模式: 否

正在扫描路径: D:\a
查找前缀: B
============================================================
创建目标路径: D:\result
开始查找并移动文件夹...
============================================================
✓ 移动文件夹: B1
  从: D:\a\中文文件夹1\B1
  到: D:\result\中文文件夹1\B1
✓ 已移动第 1 个文件夹

✓ 移动文件夹: B2
  从: D:\a\中文文件夹1\B2
  到: D:\result\中文文件夹1\B2
✓ 已移动第 2 个文件夹

============================================================
移动完成！成功移动了 2 个文件夹
结果保存在: D:\result
```

### 状态标识

- `✓` - 操作成功
- `✗` - 操作失败
- `警告` - 需要注意的情况

## 安全注意事项

### 1. 备份重要数据
在执行移动操作前，建议备份重要的文件夹数据。

### 2. 使用试运行模式
首次使用时，建议先启用试运行模式（`DRY_RUN = True`）预览操作结果。

### 3. 路径冲突处理
如果目标路径已存在同名文件夹，脚本会自动删除并覆盖。

### 4. 权限检查
确保对源路径和目标路径有足够的读写权限。

## 常见问题

### Q1: 脚本运行后没有找到任何文件夹？
**A**: 检查以下几点：
- 确认 `FOLDER_PREFIX` 设置正确
- 确认 `PROCESS_PATH` 路径存在且包含子文件夹
- 检查文件夹名称是否确实以指定前缀开头

### Q2: 移动操作失败怎么办？
**A**: 可能的原因：
- 目标路径权限不足
- 磁盘空间不足
- 文件被其他程序占用

### Q3: 如何恢复误删的文件夹？
**A**: 建议：
- 使用试运行模式先预览操作
- 定期备份重要数据
- 使用版本控制工具管理文件

## 技术细节

### 算法说明

1. **递归遍历**：使用 `os.walk()` 递归遍历所有子目录
2. **前缀匹配**：使用 `startswith()` 方法匹配文件夹名称
3. **路径计算**：使用 `os.path.relpath()` 计算相对路径
4. **安全移动**：使用 `shutil.move()` 进行文件夹移动

### 性能优化

- 避免重复处理：从目录列表中移除已处理的文件夹
- 批量操作：逐个处理文件夹，避免内存占用过大
- 错误恢复：单个文件夹失败不影响其他文件夹的处理

## 版本信息

- **版本**: 1.0
- **作者**: 自动化工具
- **更新日期**: 2024年
- **兼容性**: Python 3.6+

## 许可证

本工具仅供学习和个人使用，请遵守相关法律法规。

---

**注意**: 使用本工具前请仔细阅读说明文档，确保理解操作流程和风险。建议在重要数据上使用前先进行测试。 